# ellipsoid-sphere-fitting-sensor-calibration-stm32
This repository contains the ellipsoid sphere fitting calibration method based on C and STM32. This method originally is developed by STMicroelectronics co. based on MATLAB which you can find in the following link https://tinyurl.com/jfs3v29s. 
This library is tested on sampled data from Lis3mdl magnetometer on STM32F103RBTx.
Default project files and other settings related to peripheralls such as gpio, ... are generated by STM32CubeMx based on SW4STM32 Toolchain.

# Notes
1. The library calculates Offsets, Gains and Rotation Matrix Refinement.
2. It calculates eigenvalues and eigenvector based on JACOBI_EIGENVALUE which is developed by John Burkardt in C.
3. This library is based on "Reference implementation" script section "%rotated ellipsoid" and "Rotation matrix refinement" script.
  
# How To Use ?
1. Add defined symbols from "Preprocessor_Defined_Symbols.jpg" to your project.
2. Add libraries "c" & "m" as you can see in "Libraries.jpg" to your project.
3. Place all .c files in "CMSIS_arm_mat_c_files.rar" in your Core/Src/ project directory.
4. Place "ellipsoidfit.c" in your Core/Src/ project directory.
5. Place "ellipsoidfit.h" in your Core/Inc/ project directory.
6. View main.c to know how to call the method and pass your uncalibrated data to it. 
